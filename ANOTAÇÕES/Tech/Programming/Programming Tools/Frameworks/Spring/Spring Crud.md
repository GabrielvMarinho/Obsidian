Let's build a minimal application using [[Spring Web]], [[Spring Data JPA]] and [[H2 Database]]

This sets a simple [[CRUD]] to create a small [[API]]


It's interesting how they have APIs with the same [[URL]]s but different [[HTTP]] [[Method]]s

This code has a high level of abstraction since even the [[JSON]]s are generated by the [[Framework]]!
# java

## /com.example.demo

#### /controler (package)

UsuarioController.java
```
package com.example.demo.controller;  
  
import com.example.demo.model.Usuario;  
import com.example.demo.repository.UsuarioRepository;  
import org.springframework.beans.factory.annotation.Autowired;  
import org.springframework.http.ResponseEntity;  
import org.springframework.web.bind.annotation.*;  
  
import java.util.List;  

//this will acces UsuarioRepository which has all the crud methods and basically attach them to the API
@RestController  
@RequestMapping("/usuarios")  
public class UsuarioController {  
    @Autowired  
    private UsuarioRepository usuarioRepository;  
  
    @GetMapping  
    public List<Usuario> getAllUsuarios() {  
        return usuarioRepository.findAll();  
    }  
  
    @GetMapping("/{id}")  
    public ResponseEntity<Usuario> getUsuarioById(@PathVariable Long id) {  
        return usuarioRepository.findById(id)  
                .map(ResponseEntity::ok)  
                .orElse(ResponseEntity.notFound().build());  
    }  
  
    @PostMapping  
    public Usuario createUsuario(@RequestBody Usuario usuario) {  
        return usuarioRepository.save(usuario);  
    }  
  
    @PutMapping("/{id}")  
    public ResponseEntity<Usuario> updateUsuario(@PathVariable Long id, @RequestBody Usuario usuarioDetails) {  
        return usuarioRepository.findById(id).map(usuario -> {  
            usuario.setNomeUsuario(usuarioDetails.getNomeUsuario());  
            usuario.setSenha(usuarioDetails.getSenha());  
            Usuario updatedUsuario = usuarioRepository.save(usuario);  
            return ResponseEntity.ok(updatedUsuario);  
        }).orElse(ResponseEntity.notFound().build());  
    }  
  
    @DeleteMapping("/{id}")  
    public ResponseEntity<Void> deleteUsuario(@PathVariable Long id) {  
        if (usuarioRepository.existsById(id)) {  
            usuarioRepository.deleteById(id);  
            return ResponseEntity.noContent().build();  
        }  
        return ResponseEntity.notFound().build();  
    }  
}
```
#### /model (package)

Usuario.java
```
  
package com.example.demo.model;  
  
import jakarta.persistence.Entity;  
import jakarta.persistence.GeneratedValue;  
import jakarta.persistence.GenerationType;  
import jakarta.persistence.Id;  
  
//will basically tell Spring that this class will need to be turned into a DB table, that's why in this project we never even set a SQL command

@Entity //Mapeamento para BD  
public class Usuario {  
    @Id  
    @GeneratedValue(strategy = GenerationType.IDENTITY)  
    private Long id;  
    private String nomeUsuario;  
    private String senha;  
  
    // Construtores, getters e setters  
    public Usuario() {}  
  
    public Usuario(String nomeUsuario, String senha) {  
        this.nomeUsuario = nomeUsuario;  
        this.senha = senha;  
    }  
  
    public Long getId() {  
        return id;  
    }  
  
    public void setId(Long id) {  
        this.id = id;  
    }  
  
    public String getNomeUsuario() {  
        return nomeUsuario;  
    }  
  
    public void setNomeUsuario(String nomeUsuario) {  
        this.nomeUsuario = nomeUsuario;  
    }  
  
    public String getSenha() {  
        return senha;  
    }  
  
    public void setSenha(String senha) {  
        this.senha = senha;  
    }  
}
```
#### /repository (package)

UsuarioRepository.java
```
package com.example.demo.repository;  
  
import com.example.demo.model.Usuario;  
import org.springframework.data.jpa.repository.JpaRepository;  

//this will extend an existant class with all the crud methods out there
public interface UsuarioRepository extends JpaRepository<Usuario, Long> {}
```
#### /DemoApplication.java

DemoApplication.java
```
package com.example.demo;  
  
import org.springframework.boot.SpringApplication;  
import org.springframework.boot.autoconfigure.SpringBootApplication;  
  
@SpringBootApplication  
public class DemoApplication {  
  
    public static void main(String[] args) {  
       SpringApplication.run(DemoApplication.class, args);  
    }  
  
}
```